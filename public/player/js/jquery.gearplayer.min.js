!function(e,t,a,o){"use strict";var n,i,l,r=navigator.userAgent,s=r.match(/Mobi/i)?!0:!1,u=!!(navigator.mimeTypes["application/x-shockwave-flash"]||t.ActiveXObject&&new ActiveXObject("ShockwaveFlash.ShockwaveFlash")),f=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),d=r.toLowerCase().indexOf("android")>-1,c=!1,h=!0,p=function(){return"ontouchstart"in t||navigator.maxTouchPoints};"file:"==t.location.protocol&&alert("Whoops! You need a Webserver to run Gear Player. Get a local one here: https://www.apachefriends.org/"),e.fn.gearPlayer=function(t){return this.refresh=function(){h&&console.log("called refresh"),g.check()},this.show=function(){h&&console.log("called show"),null!==w&&w.show()},this.destroy=function(){h&&console.log("called destroy"),g.destroy()},this.ready=function(e){h&&console.log("summoned on ready event, wait for callback..."),m.onReady=e},this.play=function(e){e="undefined"==typeof e?!1:e,e&&n.geargroup.callSector(e),null!==m.sound&&m.sound.paused&&m.togglePause()},this.pause=function(){null===m.sound||m.sound.paused||m.togglePause()},this.volume=function(e){h&&console.log("set volume level to:"+e),m.setVolume(e)},this.change=function(e){m.onChange=e},this.album=function(t){e.getJSON(t,function(e){h&&console.log("success JSON: "+e),m.album(e,!1,!1),g.reset()})},this.get=function(e){var t;switch(e){case"volume":t=m.volume;break;case"paused":t=null!==m.sound?m.sound.paused:!0;break;case"title":t=v.albumTitle;break;case"author":t=v.albumAuthor;break;case"deeplink":t=m.deeplink;break;case"total":t=l.length;break;case"current":t=v.current+1;break;case"open":t=w.open;break;case"entries":t=l}return t},this.loop=function(e){m.loop=e},this.deeplink=function(e){g.deeplink=e},this.specialChars=function(e){g.specialChars=e},this.directionRTL=function(e){g.directionRTL=e},this.stayAwake=function(e){g.stayAwake=e},this.each(function(){var e=Object.create(g);e.init(t,this)})},e.fn.gearPlayer.options={id:"gearContainer",albumCover:"/img/artwork.jpg",albumTitle:"Album Title",albumAuthor:"John Doe",soundcloudEnabled:!1,soundcloudClientID:"Your Soundcloud client ID",soundcloudSet:"Your Soundcloud music Set",soundcloudOverwrite:!0,autoPlay:!0,shuffle:!0,volume:100,peak:!0,equalizer:!0,equalizerSVG:!1,equalizerSize:200,equalizerPadding:25,equalizerColor:"#EAEAEA",equalizerBars:128,equalizerRatio:.6,loadWaveform:!1,width:800,height:800,outerRay:140,innerRay:130,outerPadding:50,innerPadding:20,sectorPadding:2.5,trackColor:"#111111",loadedColor:"#222222",progressColor:"#EAEAEA",loadedThickness:26,progressThickness:18,timeColor:"#FFFFFF",timeSize:20,randomColors:!0,textColor:"#FFFFFF",overColor:"#F2F2F2",titleSize:14,authorSize:12,iconsIdleColor:"#FFFFFF",iconsActiveColor:"#FF0051",playClass:"gear-play-circle-outline",pauseClass:"gear-pause-circle-outline",shuffleClass:"gear-shuffle",replayClass:"gear-replay",volumeClass:"gear-volume-up",volumeDownClass:"gear-volume-down",muteClass:"gear-volume-mute",playlistClass:"gear-playlist-play",smFlashVersion:9,smUseWaveformData:!0,smUseEQData:!1,smUsePeakData:!0,smPreferFlash:!0,smUsePolicyFile:!0,smUrl:"swf/",stayAwake:!1,dockToRight:!1};var g={init:function(t,a){function l(t,a){e.getJSON(t,function(t){if(h&&console.log("loading setup"),h&&console.log("deeplink? "+g.deeplink),a){t.soundcloudEnabled===o&&(t.soundcloudEnabled=!1);var n=e.extend(g.data,t);h&&console.log("merged json is:"+n.albumTitle+", id: "+n.id+" soundcloud? "+n.soundcloudEnabled),g.create(n)}else if(null!==g.deeplink&&null===g.data)g.data=t,l(g.deeplink,!0);else{var i=e.extend(e.fn.gearPlayer.options,t);g.create(i)}})}h&&console.log("init gear player");var n=this;n.elem=a,n.$elem=e(a),n.options=e.extend({},e.fn.gearPlayer.options,t),h&&console.log("options are: "+n.options.id);var i=n.$elem.children(".gear").attr("data-gear");h&&console.log(i),l(i,!1)},create:function(r){function f(){v.create(g.setup);var t=0,o=1;if(n=new Raphael(g.setup.id,g.setup.width,g.setup.height),i=n.geargroup(g.setup.id,.5*g.setup.width+t,.5*g.setup.height+o,g.setup.outerRay,g.setup.innerRay,g.setup,e),m.init(g.setup),g.check(),c){var l=a.createElement("div");l.id="debugMobile",l.className="debugMobile",a.getElementsByTagName("body")[0].appendChild(l)}}h&&console.log("initialize gear: "+r),g.setup=r,g.organize(r),g.stayAwake=g.setup.stayAwake,t.soundManager=new SoundManager,u&&!s&&(soundManager.flashVersion=g.setup.smFlashVersion,soundManager.flash9Options.useWaveformData=g.setup.smUseWaveformData,soundManager.flash9Options.useEQData=g.setup.smUseEQData,soundManager.flash9Options.usePeakData=g.setup.smUsePeakData,soundManager.preferFlash=g.setup.smPreferFlash,soundManager.usePolicyFile=g.setup.smUsePolicyFile,soundManager.url=g.setup.smUrl),soundManager.beginDelayedInit(),v.soundcloudEnabled=g.setup.soundcloudEnabled!==o?g.setup.soundcloudEnabled:!1,v.soundcloudClientID=g.setup.soundcloudClientID!==o?g.setup.soundcloudClientID:0,v.soundcloudEnabled?(g.setup.randomColors=!0,v.soundCloudInitialized=!0,SC.initialize({client_id:v.soundcloudClientID}),SC.get("/resolve",{url:g.setup.soundcloudSet},function(e){r.soundcloudOverwrite?(v.albumTitle=r.albumTitle,v.albumAuthor=r.albumAuthor,v.albumCover=r.albumCover):(v.albumTitle=e.title,v.albumAuthor=e.user.username,v.albumCover=null!==e.artwork_url?e.artwork_url:e.user.avatar_url),v.albumUrl=e.permalink_url,v.authorUrl=e.user.permalink_url,h&&console.log("artwork: "+e.permalink_url),SC.get("/playlists/"+e.id,function(e){for(var t=[],a=0;a<e.tracks.length;a++)t.push({id:e.tracks[a].id,number:a,title:e.tracks[a].title,author:e.tracks[a].user.username,media:e.tracks[a].stream_url+"?client_id="+v.soundcloudClientID,link:e.tracks[a].permalink_url,duration:e.tracks[a].duration,waveform_url:e.tracks[a].waveform_url,color:"#000000"});l=t.slice(0),f()})})):(h&&console.log("no soundcloud"),v.albumTitle=r.albumTitle,v.albumAuthor=r.albumAuthor,v.albumCover=r.albumCover,l=g.setup.entries.slice(0),f())},check:function(){h&&console.log("scanning for albumns"),e("[data-gearPath]").each(function(){var t=e(this),a=t.attr("data-gearPath");e.getJSON(a,function(e){h&&console.log("success JSON: "+e);var a=(e.albumTitle+" - "+e.albumAuthor).replace(/ /g,"").toLowerCase();t.attr({"data-deeplink":a}),t.click(function(){t.hasClass("playing")?m.album(e,!0,!0):(g.reset(),t.addClass("playing"),m.album(e,!1,!0))})})})},reset:function(){e("[data-gearPath]").each(function(){e(this).hasClass("playing")&&e(this).removeClass("playing")})},organize:function(e){var t=Object.size(g.options);h&&console.log("fuse! "+t);for(var a in g.options)g.options.hasOwnProperty(a)&&e[a]===o&&(h&&console.log("SETUP does not have: "+a+" - parsing default value: "+g.options[a]),g.setup[a]=g.options[a],h&&console.log("parsed: "+g.setup.propName))},destroy:function(){h&&console.log("destroying everything..."),v.clear(),v.r.clear(),m.clear(),n.geargroup.clear(),w.clear(),y.r.clear(),e("[data-gearPath]").each(function(){e(this).unbind("click")}),v=m=i=l=y=n=w=g=null},setup:[],data:null,deeplink:null,specialChars:!1,directionRTL:!1,stayAwake:!1,forceRefresh:null},m={init:function(o){function l(t){var a=t.keyCode;switch(h&&console.log("Pressed: "+a),a){case 38:t.preventDefault(),("hidden"!=e(".gearWrap").css("visibility")||m.shift)&&m.volumeUp();break;case 40:t.preventDefault(),("hidden"!=e(".gearWrap").css("visibility")||m.shift)&&m.volumeDown();break;case 16:m.shift=!0;break;case 39:m.shift&&t.preventDefault();break;case 37:m.shift&&t.preventDefault()}}function r(t){var a=t.keyCode;switch(h&&console.log("Released: "+a),a){case 39:("hidden"!=e(".gearWrap").css("visibility")||m.shift)&&(t.preventDefault(),m.clear(),m.next());break;case 37:("hidden"!=e(".gearWrap").css("visibility")||m.shift)&&(t.preventDefault(),m.clear(),m.prev());break;case 16:m.shift=!1}}if(e(".gearWrap").css({display:"none"}),e(".stage").css({display:"block"}),g.directionRTL&&e("body").css("direction","rtl"),g.stayAwake&&s&&(g.forceRefresh=setInterval(function(){location.href=location.href,t.setTimeout(t.stop,0)},3e4)),v.enable(o),m.autoPlay=o.autoPlay,v.shuffling=o.shuffle,v.peakEnabled=o.peak,null===localStorage.getItem("gearVolume"))m.volume=o.volume;else{var i=parseInt(localStorage.getItem("gearVolume"));m.volume=i>100?100:i}soundManager.setup({onready:function(){h&&console.log("Sound Manager is ready and kicking!");var t=a.getElementById("gearBtn");TweenMax.to(t,.5,{autoAlpha:1}),b.ready=!0,w.documentTitle=a.title,h&&console.log("autoplay is: "+m.autoPlay),m.autoPlay===!0?(p&&s?(v.setStatus("pause"),v.showButton(0),w.hide()):(h&&console.log("autoplaying... with shuffle? "+v.shuffling),n.geargroup.callSector(0),v.showTime(0)),w.parseCover()):(v.setStatus("pause"),v.showButton(0),w.parseCover()),null!==m.onReady&&e.isFunction(m.onReady)&&(h&&console.log("Found on ready function! Lets call it..."),setTimeout(m.onReady,400),e(".gearWrap").hasClass("inline")&&w.show())},ontimeout:function(){h&&console.log("Sound Manager timeout!")}}),a.addEventListener("keydown",l,!1),a.addEventListener("keyup",r,!1)},playSound:function(t,a){v.current=v.ordered[a];var n,o=v.select(a);e("#_gNumbers .current").text(("0"+Number(o+1)).slice(-2)),e("#_gNumbers .total").text(("0"+Number(l.length)).slice(-2)),v.soundcloudEnabled?u?m.getSound(t,a,n):t.loadWaveform?m.getWave(t,a,n):(n=l[o].media,m.createSound(t,a,n)):(h&&console.log("local media policies"),n=l[o].media,m.createSound(t,a,n)),null!==m.onChange&&e.isFunction(m.onChange)&&m.onChange("play")},getWave:function(t,a,o){var n=v.select(a);b.ready=!1,h&&console.log("getting waveform data"),c&&e(".debugMobile").text("getting waveform data"),e.ajax({url:"http://waveformjs.org/w?url="+l[n].waveform_url,dataType:"jsonp",success:function(t){h&&console.log("wavedata: "+t.length+"/"+l[n].duration),c&&e(".debugMobile").text("wavedata: "+t.length),b.wave.length=0,b.wave=t.slice(0)},complete:function(){c&&e(".debugMobile").text("waveform complete: "+b.wave),m.getSound(t,a,o)}})},getSound:function(t,a,o){var n=v.select(a);h&&console.log("getting sound from cloud"),e.ajax({url:"utils/graburl.php?client_id="+v.soundcloudClientID+"&track_id="+l[n].id,dataType:"text",success:function(e){h&&console.log("real url is: "+e+" normal url is: "+l[n].media),o=e,m.createSound(t,a,o)},error:function(){h&&console.log("error loading url"),o=l[n].media,m.createSound(t,a,o)},complete:function(){b.ready=!0}})},createSound:function(t,a,i){h&&console.log("summoning track number: "+a),v.current=v.ordered[a];var r=v.select(a),f=l[r].type?l[r].type:"audio/mp3";h&&console.log("selected is: "+r),h&&console.log("current is set to: "+v.current),h&&console.log("order is: "+v.shuffled),h&&console.log("playing: "+l[r].title),h&&console.log("live mode enabled: "+l[r].live),h&&console.log("live duration is: "+l[r].liveDuration),"undefined"!=l[r].live&&l[r].live===!0?(v.live=l[r].live,v.liveDuration=l[r].liveDuration!==o?36e5*l[r].liveDuration:288e5):(v.live=!1,v.liveDuration=0),TweenMax.to(e("#gearMiniLabel"),.2,{width:0,onComplete:function(){"hidden"==e(".gearWrap").css("visibility")&&(e(".gearMini").hasClass("right")?TweenMax.to(e("#gearMiniPlayer"),.5,{right:0}):TweenMax.to(e("#gearMiniPlayer"),.5,{left:0})),e("#gearMiniTitle").html(l[r].title),e("#gearMiniAuthor").html(l[r].author),e("#gearMiniTitle, #gearMiniAuthor").css({width:"auto"}),w.musicTitle="♪ "+l[r].title+" — "+l[r].author,w.title()}}),null!==m.sound?(v.clear(),m.clear()):w.showNumbers(),h&&console.log("media link: "+i),m.sound=soundManager.createSound({id:"currentSound",url:i,autoLoad:!0,autoPlay:!0,type:f,volume:m.volume,whileloading:function(){v.setLoaded(this.bytesLoaded,this.bytesTotal,v.ray),m.loaded=!1},onbufferchange:function(){this.isBuffering?m.onBuffering():m.onBuffered()},onplay:function(){this.isHTML5&&!t.loadWaveform?v.peakEnabled=!1:v.peakEnabled=!0,v.live&&v.setLoaded(100,100,v.ray),v.setStatus("play"),v.clicked=!1,n.geargroup.fixArc(r)},onpause:function(){v.setStatus("pause")},onresume:function(){v.setStatus("play")},onload:function(){m.loaded=!0},whileplaying:function(){m.sound.paused||"hidden"==e(".gearWrap").css("visibility")?(m.position=this.position,e(".gearWrap").hasClass("inline")||m.sound.paused||y.update(this.position,m.loaded?this.duration:this.durationEstimate)):(m.position=this.position,m.duration=t.soundCloudEnabled?l[r].duration:this.duration,m.interacting||this.isBuffering||(v.setTime(m.getTime(this.position,!0)),v.setProgress(this.position,m.loaded?this.duration:this.durationEstimate,v.ray)),t.equalizer&&u&&!b.loadWaveform&&!s&&!this.isHTML5&&m.volume>0&&b.update(this.waveformData.left),t.peak&&u&&!b.loadWaveform&&!s&&!this.isHTML5&&m.volume>0?n.geargroup.updatePeak(r,this.peakData.left):t.loadWaveform&&t.peak&&n.geargroup.updatePeak(r,b.peak()))},onfinish:function(){v.progress.hide(),v.setProgress(0,100,v.ray),this.destruct(),m.next()},ontimeout:function(e){h&&console.log("timeout error: "+e.error.type)}})},rotateProgress:function(){function a(){v.progress.attr({transform:"r0,"+e+","+e}),v.progress.stop().animate({transform:"r"+t+","+e+","+e},1500,"<>",o)}function o(){m.buffered||m.interacting||m.scrubbing||a(),clearTimeout(n)}v.setProgress(0,100,v.ray);var e=.5*v.consoleSize,t=360,n=setTimeout(o,1e3)},onBuffering:function(){m.buffered=!1,m.rotateProgress()},onBuffered:function(){m.buffered=!0},idle:function(){h&&console.log("idle timer!"),m.sound.paused?v.setStatus("pause"):v.setStatus("play"),v.showTime(.25);var t=Math.floor(m.sound.position),a=Math.floor(m.loaded?m.sound.duration:m.sound.durationEstimate);v.live&&(a=v.liveDuration),h&&console.log("values: "+t+"/"+a),v.progress.stop().animate({arc:[t/a,a/a,v.ray,"progress"]},600,"easeInOut",function(){m.interacting=!1}),e(".gearWrap").hasClass("inline")||y.update(t/a,a/a)},volumeUp:function(){null!==m.sound&&(m.interacting=!0,m.volume<100?m.setVolume(m.volume+10):m.setVolume(100),v.setStatus("volume"),v.setProgress(m.volume,100,v.ray),clearTimeout(v.timer),v.timer=setTimeout(m.idle,2e3))},volumeDown:function(){null!==m.sound&&(m.interacting=!0,m.volume>0?m.setVolume(m.volume-10):m.setVolume(0),v.setStatus("volume"),v.setProgress(m.volume,100,v.ray),clearTimeout(v.timer),v.timer=setTimeout(m.idle,2e3))},setVolume:function(e){e>100&&(e=100),null!==m.sound&&m.sound.setVolume(e),m.volume=e,localStorage.setItem("gearVolume",e),h&&console.log("volume set to: "+e)},setPosition:function(e){soundManager.setPosition("currentSound",m.sound.duration*e/100),v.setProgress(m.sound.position,m.loaded?m.sound.duration:m.sound.durationEstimate,v.ray)},clear:function(){null!==m.sound&&m.sound.destruct()},getTime:function(e){var t=parseInt(e/1e3%60),a=parseInt(e/6e4%60),o=parseInt(e/36e5%24);t=10>t?"0"+t:t,o>0?v.hours=!0:v.hours=!1;var n=o>0?o+":"+a+":"+t:a+":"+t;return n},togglePause:function(){null!==m.sound?m.sound.togglePause():(n.geargroup.callSector(0),v.showConsole()),!m.touched&&s&&(m.touched=!0),v.live||null===m.sound||w.open||y.update(m.sound.position,m.loaded?m.sound.duration:m.sound.durationEstimate)},next:function(){v.clear(),v.setProgress(0,100,v.ray),setTimeout(function(){v.setProgress(0,100,v.ray),v.progress.show()},200),e(".gearWrap").hasClass("inline")||(y.update(0,100),setTimeout(function(){y.update(0,100)},50)),v.current<l.length-1?n.geargroup.callSector(v.current+1):(null!==m.onChange&&e.isFunction(m.onChange)&&m.onChange("end"),m.loop&&n.geargroup.callSector(0))},prev:function(){v.setProgress(0,100,v.ray),0===v.current?n.geargroup.callSector(l.length-1):n.geargroup.callSector(v.current-1)},album:function(t,a,i){function r(){h&&console.log("called build function"),v.pointers(l),n.geargroup.build(l,t.autoPlay),i&&w.show(),w.parseCover()}a?(h&&console.log("current album already loaded!!! calling show function..."),i&&w.show()):(e("[data-gearPlaylist]").each(function(){e(this).hasClass("playing")&&e(this).removeClass("playing")}),v.clear(),m.clear(),n.geargroup.clear(),v.soundcloudClientID=t.soundcloudClientID!==o?t.soundcloudClientID:0,v.soundcloudEnabled=t.soundcloudEnabled!==o?t.soundcloudEnabled:!1,v.soundcloudSet=t.soundcloudSet!==o?t.soundcloudSet:0,v.shuffling!=t.shuffle&&(v.toggleShuffle(),v.shuffling=t.shuffle),v.soundcloudEnabled?(h&&console.log("soundcloud is enabled"),v.soundCloudInitialized||(SC.initialize({client_id:v.soundcloudClientID}),v.soundCloudInitialized=!0),SC.get("/resolve",{url:v.soundcloudSet},function(e){h&&console.log("soundcloud resolved with: "+e),t.soundcloudOverwrite?(v.albumTitle=t.albumTitle,v.albumAuthor=t.albumAuthor,v.albumCover=t.albumCover):(v.albumTitle=e.title,v.albumAuthor=e.user.username,v.albumCover=null!==e.artwork_url?e.artwork_url:e.user.avatar_url),v.albumUrl=e.permalink_url,v.authorUrl=e.user.permalink_url,SC.get("/playlists/"+e.id,function(e){for(var t=[],a=0;a<e.tracks.length;a++)t.push({id:e.tracks[a].id,number:a,title:e.tracks[a].title,author:e.tracks[a].user.username,media:e.tracks[a].stream_url+"?client_id="+v.soundcloudClientID,link:e.tracks[a].permalink_url,duration:e.tracks[a].duration,waveform_url:e.tracks[a].waveform_url,color:"#000000"});l=t.slice(0),r()})})):(v.albumTitle=t.albumTitle,v.albumAuthor=t.albumAuthor,v.albumCover=t.albumCover,v.albumUrl=null,v.authorUrl=null,l=t.entries.slice(0),r())),m.deeplink=e(".playing").attr("data-deeplink"),null!==m.onChange&&e.isFunction(m.onChange)&&m.onChange("album")},onReady:null,onChange:null,autoPlay:!1,loop:!0,deeplink:null,sound:null,scrubbing:!1,loaded:!1,interacting:!1,volume:0,duration:0,position:0,touched:!1,shift:!1,live:!1,liveDuration:0,hours:!1,buffered:!1},y={create:function(t){var o=10,n=40,i=.5*n-o;y.ray=i;var l=a.createElement("div");l.id="gearMiniPlayer",l.className="gearMini",a.getElementById(t.id).parentNode.parentNode.appendChild(l),t.dockToRight?(l.className+=" right",e(".gearMini").css({right:"-80px",left:"auto"})):e(".gearMini").css({left:"-80px",right:"auto"}),l.onclick=function(){h&&console.log("clicked miniplayer"),w.show()},e("#gearMiniPlayer").hover(function(){var t=e("#gearMiniTitle").width(),a=e("#gearMiniAuthor").width(),o=t>a?t:a;h&&console.log("hovering: "+o),e("#gearMiniLabel>.gearTitle").html().trim()&&!s&&TweenMax.to(e("#gearMiniLabel"),.5,{width:Math.floor(o+40)+"px"})},function(){TweenMax.to(e("#gearMiniLabel"),.5,{width:0})});var r=a.createElement("span");r.id="gearMiniCircle",r.className="gearCircle",a.getElementById(l.id).appendChild(r);var u=a.createElement("div");u.id="gearMiniLabel",u.className="gearLabel",a.getElementById(l.id).appendChild(u);var f=a.createElement("span");f.id="gearMiniTitle",f.className="gearTitle",a.getElementById(u.id).appendChild(f);var d=a.createElement("span");d.id="gearMiniAuthor",d.className="gearAuthor",a.getElementById(u.id).appendChild(d);var c=new Raphael(r.id,n,n);c.circle(.5*n,.5*n,i).attr({stroke:"#FFFFFF","stroke-width":o,fill:"none",opacity:.2}),c.customAttributes.arc=function(e,t,a){null===t&&v.live&&(t=v.liveDuration);var u,o=360/t*e,i=.5*n,l=(90-o)*Math.PI/180,r=i+a*Math.cos(l),s=i-a*Math.sin(l);return u=t==e?[["M",i,i-a],["A",a,a,0,1,1,i-.01,i-a]]:[["M",i,i-a],["A",a,a,0,+(o>180),1,r,s]],{path:u}};var p={stroke:t.progressColor,"stroke-width":o};y.ring=c.path().attr(p).attr({arc:[0,100,i]}),y.r=c},update:function(e,t){TweenMax.set(y.ring,{raphael:{arc:[e,t,y.ray,"progress"]}})},r:null,ring:null,ray:0},v={create:function(o){function k(e,t){var a={x:e.x,y:e.y-Math.sqrt(Math.abs(t.x-e.x)*Math.abs(t.x-e.x)+Math.abs(t.y-e.y)*Math.abs(t.y-e.y))};return 2*Math.atan2(t.y-a.y,t.x-a.x)*180/Math.PI}function P(e,t){var a={x:.5*h,y:.5*h},o={x:e,y:t},n=k(a,o),i=n/360*100,l=v.loadedLevel/v.loadedTotal*100;null!==i&&i>0&&l>=i&&m.setPosition(i)}function L(o){o=o||t.event;var n=s?o.touches[0]:o,i=!1;f&&d&&(i=!0);var l,r;i?(l=n.pageX-e(a).scrollLeft()-e("#_gConsole").offset().left,r=n.pageY-e(a).scrollTop()-e("#_gConsole").offset().top):(l=o.offsetX||o.layerX<0?n.pageX-e(a).scrollLeft()-e("#_gConsole").offset().left:o.layerX,r=o.offsetY||o.layerY<0?n.pageY-e(a).scrollTop()-e("#_gConsole").offset().top:o.layerY),P(l,r)}w.create(o),(u&&o.equalizer&&!s||o.loadWaveform)&&b.create(o),b.usePeak=o.peak?!0:!1,b.useWave=o.equalizer?!0:!1;var n=a.createElement("div");n.id="_gConsole",n.className="gear",a.getElementById(o.id).parentNode.appendChild(n);var i=a.createElement("div");i.id="gearTrack",i.className="gear",i.className+=" rounded",a.getElementById(n.id).appendChild(i);var l=a.createElement("div");l.id="gearBtn",l.className="btn",a.getElementById(n.id).appendChild(l);var r=a.createElement("div");r.id="gearTime",r.className="time",r.innerHTML="0:00",a.getElementById(l.id).appendChild(r);var c=a.createElement("div");c.id="gearPlay",c.className="gear",c.className+=" play",a.getElementById(l.id).appendChild(c),l.onclick=function(){m.togglePause()},v.shuffling=o.shuffle,v.shuffling?TweenMax.set(e("#_gShuffle"),{color:g.setup.iconsActiveColor}):TweenMax.set(e("#_gShuffle"),{color:g.setup.iconsIdleColor}),s||e("#gearBtn").hover(function(){m.scrubbing||(v.showButton(.3),v.over=!0)},function(){m.scrubbing||v.showTime(.3),v.over=!1}),v.ray=o.innerRay-o.innerPadding;var h=2*o.innerRay,p=new Raphael("_gConsole",h,h),y=p.set(),_=p.circle(.5*h,.5*h,o.innerRay-o.innerPadding).attr({stroke:o.trackColor,"stroke-width":0*o.loadedThickness,fill:"none",opacity:1});v.consoleSize=h,p.customAttributes.arc=function(e,t,a){var s,o=360/t*e,n=.5*h,i=(90-o)*Math.PI/180,l=n+a*Math.cos(i),r=n-a*Math.sin(i);return s=t==e?[["M",n,n-a],["A",a,a,0,1,1,n-.01,n-a]]:[["M",n,n-a],["A",a,a,0,+(o>180),1,l,r]],{path:s}},v.r=p,i.style.marginLeft="-"+Math.floor(.5*h-1)+"px",i.style.marginTop="-"+Math.floor(.5*h-2)+"px",l.style.width=r.style.width=c.style.width=.4*h+"px",l.style.height=r.style.height=c.style.height=.4*h+"px",r.style.display=c.style.display=l.style.display="block",r.style.cursor=c.style.cursor=l.style.cursor="pointer",r.style.lineHeight=Math.floor(.4*h-6)+"px",c.style.lineHeight=Math.floor(.4*h-1)+"px",l.style.marginLeft="-"+Math.floor(.2*h)+"px",l.style.marginTop="-"+Math.floor(.2*h)+"px",n.style.width=n.style.height=h+"px",n.style.marginLeft="-"+Math.floor(.5*h)+"px",n.style.marginTop="-"+Math.floor(.5*h-1)+"px";var M={stroke:o.loadedColor,"stroke-linecap":"round","stroke-width":o.loadedThickness},T={stroke:o.progressColor,"stroke-linecap":"round","stroke-width":o.progressThickness},C=o.innerRay-o.innerPadding;v.loaded=p.path().attr(M).attr({arc:[0,100,C]}),v.progress=p.path().attr(T).attr({arc:[0,100,C]}),v.track=_,v.loaded.attr({opacity:0}),v.progress.attr({opacity:0}),TweenMax.set(l,{autoAlpha:0}),y.push(v.loaded),y.push(v.progress);var S=function(e,t){var a=this.ox+e,o=this.oy+t;P(a,o),m.scrubbing=!0},x=function(e,t,a){this.ox=a.offsetX||a.layerX,this.oy=a.offsetY||a.layerY},D=function(){m.scrubbing=!1};s||y.drag(S,x,D),y.mousedown(function(e){L(e)}),y.touchstart(function(e){e.preventDefault(),L(e),m.scrubbing=!1}),y.touchmove(function(e){e.preventDefault(),L(e),m.scrubbing=!0}),y.touchend(function(e){e.preventDefault()}),y.touchcancel(function(e){e.preventDefault()})},enable:function(e){v.pointers(l),v.track.stop().animate({"stroke-width":e.loadedThickness},500,"easeOut"),v.progress.stop().animate({"stroke-width":e.progressThickness},500,"easeOut")},setProgress:function(e,t,a){(isNaN(e)||!m.buffered)&&(e=0),(isNaN(t)||!m.buffered)&&(t=100),v.live&&((null===t||0===t)&&(t=v.liveDuration),e>t&&(e=t)),TweenMax.to(v.progress,.1,{raphael:{arc:[e,t,a,"progress"]},ease:Cubic.easeOut,overwrite:4})},setLoaded:function(e,t,a){isNaN(e)&&(e=0),isNaN(t)&&(t=0),e>v.loadedLevel&&(TweenMax.to(v.loaded,.5,{raphael:{arc:[e,t,a,"loaded"]},ease:Cubic.easeOut}),v.loadedLevel=e,v.loadedTotal=t)},showConsole:function(){v.loaded.attr({opacity:1}),v.progress.attr({opacity:1}),TweenMax.to(e("#_gConsole svg"),.5,{scaleX:1,scaleY:1,alpha:1,ease:Cubic.easeOut})},clear:function(){v.setTime(m.getTime(0,!0)),v.loadedLevel=0,TweenMax.set(v.progress,{raphael:{arc:[0,100,v.ray,"progress"]}}),TweenMax.set(v.loaded,{raphael:{arc:[0,100,v.ray,"loaded"]}})},setTime:function(t){function o(){v.hours?e("#gearTime").hasClass("hours")||e("#gearTime").addClass("hours"):e("#gearTime").hasClass("hours")&&e("#gearTime").removeClass("hours")}a.getElementById("gearTime").innerHTML=t,o()},showTime:function(t){TweenMax.to(e("#gearPlay"),t,{alpha:0,scaleX:0,scaleY:0,overwrite:1}),TweenMax.to(e("#gearTime"),t,{alpha:1,scaleX:1,scaleY:1,delay:t-.5*t,overwrite:2,onStart:function(){TweenMax.to(e("#gearPlay"),.5*t,{alpha:0,scaleX:0,scaleY:0,overwrite:2})}})},showButton:function(t){TweenMax.to(e("#gearPlay"),t,{alpha:1,scaleX:1,scaleY:1,delay:t-.5*t,overwrite:1}),TweenMax.to(e("#gearTime"),t,{alpha:0,scaleX:0,scaleY:0,delay:t-t,overwrite:1})},setStatus:function(e){h&&console.log("new status: "+e);var t=a.getElementById("gearPlay");switch(e){case"pause":h&&console.log("set icon to pause"),t.innerHTML="<i class='"+g.setup.playClass+"'></i>",v.showButton(.3);break;case"play":h&&console.log("set icon to play"),t.innerHTML="<i class='"+g.setup.pauseClass+"'></i>",p&&s&&v.showTime(.3);break;case"volume":h&&console.log("set icon to volume"),0===m.volume?t.innerHTML="<i class='"+g.setup.muteClass+"'></i>":t.innerHTML=m.volume>=50?"<i class='"+g.setup.volumeClass+"'></i>":"<i class='"+g.setup.volumeDownClass+"'></i>",v.showButton(.3);break;case"error":}},shuffle:function(e){for(var t,a,o=e.length;o;t=Math.floor(Math.random()*o),a=e[--o],e[o]=e[t],e[t]=a);return e},showPlaylist:function(){if(!e("#_gPlayer").hasClass("docked")&&e(t).width()<767){var a=.5*(e(t).width()+v.ray);e("#_gPlayer").addClass("docked"),TweenMax.to(e("#_gPlayer"),.5,{left:-a+"px",transformOrigin:"center center",ease:Cubic.easeInOut}),TweenMax.to(e("#_gPlaylist"),.5,{color:g.setup.iconsActiveColor})}},hidePlaylist:function(){e("#_gPlayer").hasClass("docked")&&e(t).width()<767&&(e("#_gPlayer").removeClass("docked"),TweenMax.to(e("#_gPlayer"),.5,{left:0,ease:Cubic.easeInOut}),TweenMax.to(e("#_gPlaylist"),.5,{color:g.setup.iconsIdleColor}))},togglePlaylist:function(){e("#_gPlayer").hasClass("docked")?v.hidePlaylist():v.showPlaylist()},toggleShuffle:function(){h&&console.log("toggling shuffle"),v.shuffling?(v.shuffling=!1,TweenMax.to(e("#_gShuffle"),.3,{color:g.setup.iconsIdleColor})):(v.shuffling=!0,TweenMax.to(e("#_gShuffle"),.5,{color:g.setup.iconsActiveColor}))},pointers:function(e){for(var t=0,a=e.length;a>t;t++)v.ordered.push(t);v.shuffled=v.ordered.slice(0),v.shuffle(v.shuffled),h&&console.log("ordered is: "+v.ordered),h&&console.log("shuffled is: "+v.shuffled)},select:function(e){var t=0;return t=v.shuffling&&!v.clicked?v.shuffled[e]:v.ordered[e]},r:null,track:null,progress:null,loaded:null,loadedLevel:0,loadedTotal:0,ray:0,current:0,ordered:[],shuffled:[],shuffling:!1,peakEnabled:!1,album:[],albumTitle:null,albumAuthor:null,albumCover:null,albumUrl:null,authorUrl:null,soundcloudEnabled:!1,soundcloudClientID:0,soundcloudSet:0,soundCloudInitialized:!1,clicked:!1,rotating:!1,timer:null,over:!1,consoleSize:0},w={create:function(t){e(".gearWrap").hasClass("inline")||y.create(t),e("#"+t.id).wrap("<div id='_gPlayer' class='player'></div>");var o=a.createElement("div");o.id="_gInterface",o.className="interface";var n=a.createElement("div");n.id="_gOverlay",n.className="overlay",a.getElementById(t.id).parentNode.parentNode.appendChild(n);var i=a.getElementById(t.id).parentNode.parentNode;i.insertBefore(n,i.firstChild);var l=a.createElement("div");l.id="_gAlbum",l.className="album",a.getElementById(t.id).parentNode.parentNode.appendChild(l),w.albumCover=a.createElement("div"),w.albumCover.id="_gAlbumCover",w.albumCover.className="cover",a.getElementById(l.id).appendChild(w.albumCover);var r=a.createElement("div");r.id="_gAlbumGroup",r.className="albumgroup",a.getElementById(l.id).appendChild(r),w.albumTitle=a.createElement("span"),w.albumTitle.id="_gAlbumTitle",w.albumTitle.className="title",w.albumTitle.onclick=function(){v.soundcloudEnabled&&null!==m.sound&&!m.sound.paused&&m.togglePause()},a.getElementById(r.id).appendChild(w.albumTitle),w.albumAuthor=a.createElement("span"),w.albumAuthor.id="_gAlbumAuthor",w.albumAuthor.className="author",a.getElementById(r.id).appendChild(w.albumAuthor);var s=a.createElement("div");s.id="_gCurrent",s.className="currentGroup",a.getElementById(t.id).parentNode.parentNode.appendChild(s),i=new Raphael("_gCurrent",w.linesize,w.linesize),w.line=i.path("M0,0 L0,0").attr({stroke:"#ffffff",opacity:.3});var u=a.createElement("div");u.id="_gNumbers",u.className="numbers",a.getElementById(s.id).appendChild(u),w.c=a.createElement("span"),w.c.className="current",w.c.style.opacity=0,a.getElementById(u.id).appendChild(w.c),w.c.innerHTML="0",w.t=a.createElement("span"),w.t.className="total",w.t.style.opacity=0,a.getElementById(u.id).appendChild(w.t),w.t.innerHTML="0";var f=a.createElement("div");f.id="_gPlaylist",f.className="playlist",a.getElementById(t.id).parentNode.parentNode.appendChild(f),f.innerHTML="<i class='"+g.setup.playlistClass+"'></i>",f.onclick=function(){v.togglePlaylist()};var d=a.createElement("div");d.id="_gClose",d.className="close",d.style.opacity=.7,a.getElementById(t.id).parentNode.parentNode.appendChild(d);var c=30,h=new Raphael("_gClose",c,c);h.path("M0,0 L"+c+","+c+", M0,"+c+" L"+c+",0").attr({stroke:"#ffffff",opacity:.9}),d.onclick=function(){w.hide()},e("#_gClose").hover(function(){TweenMax.to(e(this),.5,{alpha:1})},function(){TweenMax.to(e(this),.5,{alpha:.7})});var p=a.createElement("div");p.id="_gShuffle",p.className="shuffle",a.getElementById(t.id).parentNode.parentNode.appendChild(p),p.innerHTML="<i class='"+g.setup.shuffleClass+"'></i>",p.onclick=function(){v.toggleShuffle()}},showNumbers:function(){w.line.animate({path:"M0,0 L"+w.linesize+","+w.linesize},500,"easeOut"),TweenMax.to(w.c,.5,{alpha:1}),TweenMax.to(w.t,.5,{alpha:.5})},parseCover:function(){function n(t){var o=t.item,n=o.type;n==createjs.LoadQueue.IMAGE&&(a.getElementById(w.albumCover.id).appendChild(t.result),TweenMax.set(e("#_gAlbumCover"),{alpha:0}))}function i(){h&&console.log("cover loaded"),TweenMax.to(e("#_gAlbumCover"),.5,{alpha:1,onComplete:function(){e("#_gAlbumAuthor, #_gAlbumTitle").css({display:"block"}),TweenMax.from(e("#_gAlbumAuthor"),.5,{width:0,delay:.2,ease:Cubic.easeOut}),TweenMax.from(e("#_gAlbumTitle"),.5,{width:0,ease:Cubic.easeOut})}})}var t=v.albumCover;e("#_gAlbumAuthor, #_gAlbumTitle").css({display:"none",width:"auto"}),e("#_gAlbumCover").empty(),w.albumAuthor.innerHTML=null!==v.authorUrl?'<a href="'+v.authorUrl+'" target="_blank">'+v.albumAuthor+"</a>":v.albumAuthor,w.albumTitle.innerHTML=null!==v.albumUrl?'<a href="'+v.albumUrl+'" target="_blank">'+v.albumTitle+"</a>":v.albumTitle;var o=new createjs.LoadQueue(!0);o.loadFile({src:t,type:createjs.LoadQueue.IMAGE}),o.on("fileload",n,this),o.on("complete",i,this),o.load()},hide:function(){TweenMax.to(e(".gearWrap"),.5,{autoAlpha:0,onComplete:function(){e(".gearMini").hasClass("right")?TweenMax.to(e(".gearMini"),.5,{right:0}):TweenMax.to(e(".gearMini"),.5,{left:0}),e(".gearWrap").css({display:"none"})}}),w.enableScroll(),w.open=!1,w.title(),null!==m.onChange&&e.isFunction(m.onChange)&&m.onChange("hide")},show:function(){w.open&&"none"!=e(".stage").css("display")||(h&&console.log("show interface"),w.open=!0,w.documentTitle=a.title,w.title(),e(".gearWrap").hasClass("inline")||w.disableScroll(),TweenMax.to(e("#gearMiniLabel"),.2,{width:0,onStart:function(){e(".gearWrap").css({display:"block"})},onComplete:function(){TweenMax.to(e(".gearWrap"),.5,{autoAlpha:1}),e(".gearMini").hasClass("right")?TweenMax.to(e(".gearMini"),.5,{right:"-"+2*e(".gearMini").width()+"px"}):TweenMax.to(e(".gearMini"),.5,{left:"-"+2*e(".gearMini").width()+"px"}),TweenMax.from(e("#_gPlayer"),.5,{scaleX:.5,scaleY:.5})}}),null!==m.onChange&&e.isFunction(m.onChange)&&m.onChange("show"))},disableScroll:function(){t.addEventListener&&t.addEventListener("DOMMouseScroll",w.wheel,!1),t.onmousewheel=a.onmousewheel=w.wheel,a.onkeydown=w.keydown,e("body").bind("touchmove",function(e){e.preventDefault()}),w.y=e(t).scrollTop(),e(".gearWrap").hasClass("inline")||e(".stage").css({display:"none"})},enableScroll:function(){
t.removeEventListener&&t.removeEventListener("DOMMouseScroll",w.wheel,!1),t.onmousewheel=a.onmousewheel=a.onkeydown=null,e("body").unbind("touchmove"),e(".stage").css({display:"block"}),t.scrollTo(0,w.y)},keydown:function(e){for(var t=w.keys.length;t--;)if(e.keyCode===w.keys[t])return void w.prevent(e)},wheel:function(e){w.prevent(e)},prevent:function(e){e=e||t.event,e.preventDefault&&(e.preventDefault(),e.returnValue=!1)},clear:function(){w.hide(),Draggable.get("#gearContainer").kill(),e(".gearWrap, .gearMini").remove()},title:function(){w.open?a.title=null!==w.musicTitle?w.musicTitle:w.documentTitle:a.title=w.documentTitle},keys:[37,38,39,40],line:null,linesize:100,c:null,t:null,albumTitle:null,albumAuthor:null,albumCover:null,albumUrl:null,authorUrl:null,open:!1,y:0,documentTitle:null,musicTitle:null},b={create:function(e){b.loadWaveform=e.loadWaveform;var t=a.createElement("div");t.id="_gEqualizer",t.className="gear";var o=a.getElementById(e.id).parentNode;o.insertBefore(t,o.firstChild);var n=e.equalizerSize;t.style.marginLeft="-"+.5*n+"px",t.style.marginTop="-"+.5*n+"px",t.style.width=t.style.height=n+"px",b.svg=e.equalizerSVG,b.n=e.equalizerBars,b.r=.5*n-e.equalizerPadding,b.w=e.equalizerPadding,b.cx=.5*n,b.cy=.5*n,b.clr=e.equalizerColor,b.ratio=e.equalizerRatio;var i=a.createElement("canvas");i.id="eqCanvas",i.width=i.height=n,a.getElementById(t.id).appendChild(i),b.canvas=a.getElementById("eqCanvas"),b.canvas.getContext&&(b.ctx=b.canvas.getContext("2d"));for(var l=0,r=256;r>l;l++)b.old.push(0)},update:function(e){e.onUpdate=function(){b.draw(b.old)},TweenLite.to(b.old,.14,e)},peak:function(){var e=Math.floor(b.wave.length*(m.position/m.duration)),t=Math.sin(2*Math.PI*b.wave[e]),a=parseFloat(Math.abs(t)).toPrecision(12),o=a*m.volume/100;return o},waveform:function(){var e=[],t=256;v.current=v.current<t?v.current++:0;for(var a=Math.floor(b.wave.length*(m.position/m.duration)),o=0,n=t;n>o;o++){var i=b.peak(),l=a,r=b.wave[a+o],s=i*Math.sin(l*r);e.push(s)}return e},loading:function(){function o(){e.length=0;var o=.6,n=.05,i=24;t=a>t?t++:0;for(var l=0,r=a;r>l;l++){var s=Math.sin(n*(l-t+i))*o,u=.2*Math.sin(s*Math.PI-t);e.push(u)}TweenLite.to(b.old,.2,e)}var e=[],t=0,a=256;o(),e.onUpdate=function(){b.draw(b.old)},e.onComplete=function(){b.ready?(TweenMax.killTweensOf(b.old),b.done()):o()}},done:function(){for(var e=[],t=256,a=0,o=t;o>a;a++)e.push(0);TweenLite.to(b.old,.2,e),e.onUpdate=function(){b.draw(b.old)}},draw:function(e){b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height);for(var t=0,a=b.n;a>t;t++){var o=360/b.n*t,n=Math.floor(256*t/b.n),i=e[n]*b.w,l=b.getPoints(o,b.r,i),r=360/b.n*b.ratio,s=o-.5*r,u=o+.5*r;b.drawSolidArc(b.toRad(s),b.toRad(u),b.clr,b.r,e[n]*b.w,b.toRad(r),l)}},toRad:function(e){return e*Math.PI/180},getPoints:function(e,t,a){var o=e*(Math.PI/180),n=b.cx,i=b.cy,l=Math.ceil(Math.cos(o)*t+n),r=Math.ceil(Math.sin(o)*t+i),s=Math.ceil(Math.cos(o)*(t-a)+n),u=Math.ceil(Math.sin(o)*(t-a)+i);return{radian:o,startX:l,startY:r,endX:s,endY:u}},drawSolidArc:function(e,t,a,o,n){b.ctx.fillStyle=b.clr;var i=o-n;b.ctx.beginPath(),b.ctx.arc(b.cx,b.cy,o,e,t,!1);var l=b.getArcEndpointCoords(i,t);b.ctx.lineTo(l.x,l.y),b.ctx.arc(b.cx,b.cy,i,t,e,!0),b.ctx.closePath(),b.ctx.fill()},getArcEndpointCoords:function(e,t){return{x:e*Math.cos(t)+b.cx,y:e*Math.sin(t)+b.cy}},clear:function(){b.ctx.clearRect(0,0,b.canvas.width,b.canvas.height)},usePeak:!1,useWave:!1,data:[],wave:[],current:0,loadWaveform:!0,ready:!1,e:null,n:0,r:0,w:0,cx:0,cy:0,clr:"#FFF",ratio:1,svg:!0,canvas:null,ctx:null,old:[],zero:[]};Raphael.fn.geargroup=function(e,t,o,n,i,r,f){function S(e,t,a,o,n,l){var r=e+a*Math.cos(-o*c),s=e+a*Math.cos(-n*c),u=t+a*Math.sin(-o*c),f=t+a*Math.sin(-n*c),h=e+i*Math.cos(-o*c),p=e+i*Math.cos(-n*c),g=t+i*Math.sin(-o*c),m=t+i*Math.sin(-n*c);return d.path(["M",h,g,"L",r,u,"A",a,a,0,+(n-o>180),0,s,f,"L",p,m,"A",i,i,0,+(n-o>180),1,h,g,"z"]).attr(l)}function x(){var e=12*Math.floor(30*Math.random());return f.Color({hue:e,saturation:.9,lightness:.6,alpha:1}).toHexString()}function I(){h&&console.log("iterating");for(var e=0,t=l.length;t>e;e++)E(e)}var d=this,c=Math.PI/180,y=[],w=[],b=[],_=[],M=[],T=[],C=[],k=[],P=this.set(),D=0,L=0,O=[],E=function(a){function ie(t){h&&console.log("doing sector n: "+t);var a=v.select(t);h&&console.log("velocity is:"+A.getVelocity("rotation")),(A.getVelocity("rotation")<5&&A.getVelocity("rotation")>-5||!A.getVelocity("rotation"))&&(h&&console.log("tracker is ready"),m.playSound(r,t),TweenMax.to(f("#"+e),1,{rotation:T[a]+"_short",ease:Cubic.easeOut,onStart:function(){v.rotating=!0,h&&console.log("start rotation")},onComplete:function(){v.rotating=!1,h&&console.log("end rotation"),le(a),ue(a)}})),v.showConsole()}function le(e){h&&console.log("rearranging arcs...");for(var t=0,a=l.length;a>t;t++){var o=_[t];t!=e?o.stop().animate({path:M[t]},H,">",function(){}):v.peakEnabled&&u&&!s||o.stop().animate({path:C[t].attr("path")},H)}}function re(){i.click(function(){h&&console.log("clicked on: "+a+"/ already clicked?"+v.clicked),v.clicked=!0,ie(a)})}function se(){h&&console.log("handling touch..."),i.touchstart(function(e){e.preventDefault()}),i.touchend(function(e){e.preventDefault(),v.clicked=!0,ie(a)})}function ue(e){h&&console.log("selecting label");for(var t=0,a=w.length;a>t;t++){var o=y[t],n=b[t];t==e?(TweenMax.to(o,.5,{raphael:{opacity:1}}),TweenMax.to(n,.5,{raphael:{opacity:.5}}),o.data("flag",!0)):(o.data("flag",!1),TweenMax.to(o,.5,{raphael:{opacity:Y}}),TweenMax.to(n,.5,{raphael:{opacity:.5*Y}}))}}var K,Z,i=d.set(),E=d.set(),F=360*l.length/(l.length*l.length),N=D+F/2,B=l[a].color,R=null!==r.textAlpha?r.textAlpha:.3,H=500,U=r.outerPadding,W=r.randomColors?x():B,z=r.textColor,q=r.sectorPadding>0?r.sectorPadding:1e-4,j=S(t,o,n-.5*r.innerPadding,D+.5*q,D+F-.5*q,{fill:"none",stroke:"none"}),V=S(t,o,n+.5*U,D+.5*q,D+F-.5*q,{fill:"none",stroke:"none"}),X=S(t,o,n,D+.5*q,D+F-.5*q,{fill:W,stroke:"none","stroke-width":6,opacity:1}),Y=R,Q=X.attr("path"),J=j.attr("path"),G=Math.floor(+t+(+n+U)*Math.cos(-N*c)),$=Math.floor(+o+(+n+U)*Math.sin(-N*c));if(g.specialChars){var ee=g.directionRTL?"end":"start";K=d.text(G,$,l[a].title.toUpperCase()).attr({fill:z,stroke:"none",opacity:1,"font-size":r.titleSize,"font-family":"'Helvetica', Arial, sans-serif"}),K.attr({transform:"r"+-N+"t0,-"+.5*r.titleSize,"text-anchor":ee}),Z=d.text(G,$,l[a].author.toUpperCase()).attr({fill:z,stroke:"none",opacity:1,"font-size":r.authorSize,"font-family":"'Helvetica', Arial, sans-serif"}),Z.attr({transform:"r"+-N+"t0,"+.5*r.titleSize,opacity:.5*Y,"text-anchor":ee})}else K=d.print(G,$,l[a].title.toUpperCase().replace(/^(.{25}[^\s]*).*/,"$1"),d.getFont("Maven Pro"),r.titleSize).attr({fill:z,opacity:Y}),K.transform("t0,-"+.5*r.titleSize),TweenMax.set(K,{raphael:{rotation:-N,globalPivot:{x:G,y:$}}}),Z=d.print(G,$,l[a].author.toUpperCase(),d.getFont("Maven Pro"),r.authorSize).attr({fill:z,opacity:.5*Y}),Z.transform("t0,"+.5*r.authorSize),TweenMax.set(Z,{raphael:{rotation:-N,globalPivot:{x:G,y:$}}});var te=.5*(r.width-r.outerRay),ae=2*Math.PI*r.outerRay/l.length,oe=d.rect(G,$,te,ae).attr({fill:"red",opacity:0});oe.transform("t-"+r.outerPadding+",-"+.5*ae),TweenMax.set(oe,{raphael:{rotation:-N,globalPivot:{x:G,y:$}}}),O.push(D),D+=F,E.push(K),E.push(Z),i.push(E),i.push(oe),i.push(X),P.push(i),y.push(K),b.push(Z),w.push(E),_.push(X),M.push(Q),k.push(J),C.push(V),T.push(N),X.attr({path:k[a]});var ne=Raphael.animation({path:M[a]},2*H,"elastic");X.animate(ne.delay(100*a)),TweenMax.from(K,.5,{raphael:{opacity:0},delay:.1*a}),TweenMax.from(Z,.5,{raphael:{opacity:0},delay:.1*a}),Raphael.fn.geargroup.callSector=function(e){ie(e)},Raphael.fn.geargroup.fixArc=function(e){le(e)},se(),re(),s||i.mouseover(function(){K.stop().animate({opacity:1},H),Z.stop().animate({opacity:.5},H);for(var e=0,t=w.length;t>e;e++);i.attr({cursor:"pointer"})}).mouseout(function(){K.data("flag")||(K.stop().animate({opacity:Y},H),Z.stop().animate({opacity:.5*Y},H)),i.attr({cursor:"default"})}),Raphael.fn.geargroup.selectLabel=function(e){ue(e)},Raphael.fn.geargroup.updatePeak=function(e,a){if(a&&a>=0){var i=O[e],l=S(t,o,n+.5*U*a,i+.5*q,i+F-.5*q,{fill:"none",stroke:"none"}),r=_[e];r.animate({path:l.attr("path")},70,">")}},L+=.1,Raphael.fn.geargroup.clear=function(){d.clear(),y=[],w=[],b=[],_=[],M=[],T=[],C=[],k=[],O=[],D=0,L=0,y.length=w.length=b.length=_.length=M.length=T.length=C.length=k.length=O.length=0,l.length=0,l=[],v.ordered.length=0,v.ordered=[],v.shuffled.length=0,v.shuffled=[]},Raphael.fn.geargroup.build=function(e,t){I(),p&&s?t&&m.touched&&ie(v.select(0)):t&&ie(v.select(0))}};I(),a.getElementById(r.id).style.marginTop="-"+.5*r.height+"px",a.getElementById(r.id).style.marginLeft="-"+.5*r.width+"px",Draggable.create("#"+e,{type:"rotation",throwProps:!0});var A=ThrowPropsPlugin.track(a.getElementById(e),"rotation");return f("#"+e).bind("mousewheel",function(t,o){function n(){TweenMax.to(f("#"+e),.5,{rotation:a.getElementById(e)._gsTransform.rotation+360/l.length+"_short",ease:Cubic.easeOut})}function i(){TweenMax.to(f("#"+e),.5,{rotation:a.getElementById(e)._gsTransform.rotation-360/l.length+"_short",ease:Cubic.easeOut})}t.preventDefault(),o>0?i():n()}),f("#_gConsole").bind("mousewheel",function(e,t){e.preventDefault(),t>0?m.volumeUp():m.volumeDown()}),P},e.noConflict()}(jQuery,this,this.document),"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.size=function(e){var a,t=0;for(a in e)e.hasOwnProperty(a)&&t++;return t};